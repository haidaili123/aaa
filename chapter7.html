<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬ä¸ƒç« å¯è§†åŒ–å¹³å° - 3Då›¾è¡¨ä¸åŠ¨ç”»</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-pink: #FF69B4;      /* çƒ­æƒ…ç²‰çº¢ */
            --light-pink: #FFB6C1;        /* æµ…ç²‰çº¢ */
            --pale-pink: #FFF5F5;         /* è±†æ²™ç²‰ç™½ */
            --peach-pink: #FFDAB9;        /* æ¡ƒç²‰è‰² */
            --coral-pink: #FF6B6B;        /* çŠç‘šç²‰ */
            --rose-pink: #FF1493;         /* æ·±ç²‰çº¢ */
            --baby-pink: #F8BBD0;         /* å©´å„¿ç²‰ */
            --cotton-pink: #FFCCDD;       /* æ£‰èŠ±ç³–ç²‰ */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, 
                var(--pale-pink) 0%, 
                var(--baby-pink) 25%, 
                var(--peach-pink) 50%, 
                var(--cotton-pink) 75%, 
                #FFF0F5 100%);
            background-attachment: fixed;
            color: #8B4513;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 60px 40px;
            background: linear-gradient(135deg, 
                rgba(255,182,193,0.4) 0%, 
                rgba(255,192,203,0.3) 50%, 
                rgba(255,218,185,0.2) 100%);
            border-radius: 30px;
            margin-bottom: 50px;
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 60px rgba(255,105,180,0.15);
            position: relative;
            overflow: hidden;
        }

        .animated-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-pink), var(--rose-pink), var(--coral-pink), var(--primary-pink));
            background-size: 200% 100%;
            animation: slideGradient 3s ease-in-out infinite;
        }

        @keyframes slideGradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        h1 {
            font-size: 3.5rem;
            color: var(--rose-pink);
            margin-bottom: 15px;
            text-shadow: 3px 3px 6px rgba(255,20,147,0.3);
            position: relative;
            z-index: 1;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 1.4rem;
            color: var(--coral-pink);
            opacity: 0.9;
            position: relative;
            z-index: 1;
            font-weight: 300;
        }

        .modules {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(420px, 1fr));
            gap: 40px;
            margin-bottom: 50px;
        }

        .module {
            background: rgba(255,255,255,0.9);
            padding: 35px;
            border-radius: 25px;
            box-shadow: 0 15px 40px rgba(219,112,147,0.12);
            backdrop-filter: blur(15px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255,182,193,0.3);
            position: relative;
            overflow: hidden;
        }

        .module::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-pink), var(--rose-pink), var(--coral-pink));
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .module:hover::before {
            opacity: 1;
        }

        .module:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 60px rgba(219,112,147,0.25);
        }

        .module h2 {
            color: var(--rose-pink);
            margin-bottom: 25px;
            font-size: 1.8rem;
            font-weight: 600;
            position: relative;
            padding-left: 50px;
        }

        .module h2::before {
            content: attr(data-emoji);
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.5rem;
        }

        .controls {
            margin: 25px 0;
        }

        .control-group {
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .control-group label {
            min-width: 120px;
            font-weight: 500;
            color: #8B4513;
            font-size: 0.95rem;
        }

        .control-group select,
        .control-group input[type="range"],
        .control-group input[type="number"] {
            flex: 1;
            min-width: 150px;
            padding: 12px;
            border: 2px solid var(--light-pink);
            border-radius: 12px;
            background: rgba(255,255,255,0.8);
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .control-group select:focus,
        .control-group input:focus {
            outline: none;
            border-color: var(--primary-pink);
            box-shadow: 0 0 0 3px rgba(255,105,180,0.1);
        }

        .control-group button {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--primary-pink), var(--rose-pink));
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-weight: 500;
            font-size: 0.95rem;
            box-shadow: 0 4px 15px rgba(255,105,180,0.3);
            position: relative;
            overflow: hidden;
        }

        .control-group button:hover {
            background: linear-gradient(135deg, var(--rose-pink), var(--coral-pink));
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255,105,180,0.4);
        }

        .chart-container {
            width: 100%;
            height: 320px;
            margin: 25px 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,240,245,0.4));
            border-radius: 20px;
            padding: 25px;
            position: relative;
            box-shadow: inset 0 2px 10px rgba(255,182,193,0.1);
        }

        .animation-canvas {
            width: 100%;
            height: 220px;
            background: linear-gradient(135deg, rgba(0,0,0,0.03), rgba(255,182,193,0.05));
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            margin: 25px 0;
            box-shadow: inset 0 2px 10px rgba(255,182,193,0.1);
        }

        .star {
            position: absolute;
            color: #FFD700;
            font-size: 20px;
            animation: twinkle 2s infinite;
            text-shadow: 0 0 10px rgba(255,215,0,0.5);
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.3; transform: scale(0.8); }
        }

        @keyframes rotate3d {
            0% { transform: rotateY(0deg) rotateX(0deg); }
            100% { transform: rotateY(360deg) rotateX(360deg); }
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .stat {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, rgba(255,182,193,0.2), rgba(255,218,185,0.1));
            border-radius: 15px;
            border: 1px solid rgba(255,105,180,0.2);
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
        }

        .stat:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255,105,180,0.15);
            background: linear-gradient(135deg, rgba(255,182,193,0.3), rgba(255,218,185,0.2));
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--rose-pink);
            margin-bottom: 5px;
            text-shadow: 1px 1px 2px rgba(255,20,147,0.2);
        }

        .stat-label {
            font-size: 0.9rem;
            color: #8B4513;
            opacity: 0.8;
            font-weight: 500;
        }

        .code-example {
            background: linear-gradient(135deg, rgba(255,255,255,0.8), rgba(255,240,245,0.6));
            padding: 20px;
            border-radius: 15px;
            font-family: 'Courier New', 'Consolas', monospace;
            font-size: 0.9rem;
            color: #8B4513;
            margin: 20px 0;
            border-left: 4px solid var(--primary-pink);
            box-shadow: 0 4px 15px rgba(255,182,193,0.1);
            transition: all 0.3s ease;
        }

        .code-example:hover {
            transform: translateX(5px);
            box-shadow: 0 6px 20px rgba(255,182,193,0.15);
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            header {
                padding: 40px 25px;
            }
            
            h1 {
                font-size: 2.5rem;
            }
            
            .subtitle {
                font-size: 1.2rem;
            }
            
            .modules {
                grid-template-columns: 1fr;
                gap: 25px;
            }
            
            .module {
                padding: 25px;
            }
            
            .control-group {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .control-group label {
                min-width: auto;
            }
            
            .chart-container {
                height: 250px;
                padding: 20px;
            }
            
            .animation-canvas {
                height: 180px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="animated-bar"></div>
            <h1>ğŸŒ¸ ç¬¬ä¸ƒç« å¯è§†åŒ–å¹³å°</h1>
            <p class="subtitle">3Då›¾è¡¨ã€åŠ¨ç”»ä¸ç»Ÿè®¡åœ°å›¾çš„äº¤äº’å¼å­¦ä¹ ç½‘ç«™</p>
        </header>

        <div class="modules">
            <!-- æ¨¡å—1: mplot3dç»˜åˆ¶3Då›¾è¡¨ -->
            <div class="module">
                <h2 data-emoji="ğŸŒŸ">7.1 mplot3dç»˜åˆ¶3Då›¾è¡¨</h2>
                <div class="controls">
                    <div class="control-group">
                        <label>å›¾è¡¨ç±»å‹:</label>
                        <select id="chartType" onchange="updateChart3D()">
                            <option value="scatter">3Dæ•£ç‚¹å›¾</option>
                            <option value="wireframe">3Dçº¿æ¡†å›¾</option>
                            <option value="surface">3Dæ›²é¢å›¾</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>æ˜Ÿç‚¹æ•°é‡:</label>
                        <input type="range" id="starCount" min="10" max="100" value="30" oninput="updateStarCount(this.value)">
                        <span id="starCountValue">30</span>
                    </div>
                    <div class="control-group">
                        <button onclick="generateStars()">é‡æ–°ç”Ÿæˆæ˜Ÿæ˜Ÿ</button>
                        <button onclick="rotateChart()">æ—‹è½¬è§†å›¾</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="chart3d"></canvas>
                </div>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" id="totalStars">30</div>
                        <div class="stat-label">æ˜Ÿç‚¹æ€»æ•°</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="avgHeight">20</div>
                        <div class="stat-label">å¹³å‡é«˜åº¦</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="rotationAngle">0Â°</div>
                        <div class="stat-label">æ—‹è½¬è§’åº¦</div>
                    </div>
                </div>
                <div class="code-example">
                    <strong>3Dæ•£ç‚¹å›¾ç¤ºä¾‹ä»£ç ï¼š</strong><br>
                    import matplotlib.pyplot as plt<br>
                    from mpl_toolkits.mplot3d import Axes3D<br>
                    fig = plt.figure()<br>
                    ax = fig.add_subplot(111, projection='3d')<br>
                    ax.scatter(x, y, z, c='#C71585', marker='*', s=160)
                </div>
            </div>

            <!-- æ¨¡å—2: animationåˆ¶ä½œåŠ¨å›¾ -->
            <div class="module">
                <h2 data-emoji="âœ¨">7.2 animationåˆ¶ä½œåŠ¨å›¾</h2>
                <div class="controls">
                    <div class="control-group">
                        <label>åŠ¨ç”»ç±»å‹:</label>
                        <select id="animationType" onchange="updateAnimation()">
                            <option value="twinkle">é—ªçƒæ˜Ÿæ˜Ÿ</option>
                            <option value="sine">æ­£å¼¦æ³¢</option>
                            <option value="rotating">æ—‹è½¬åŠ¨ç”»</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>åŠ¨ç”»é€Ÿåº¦:</label>
                        <input type="range" id="animSpeed" min="1" max="10" value="5" oninput="updateAnimSpeed(this.value)">
                        <span id="animSpeedValue">5</span>
                    </div>
                    <div class="control-group">
                        <button onclick="playAnimation()">æ’­æ”¾åŠ¨ç”»</button>
                        <button onclick="pauseAnimation()">æš‚åœåŠ¨ç”»</button>
                        <button onclick="resetAnimation()">é‡ç½®</button>
                    </div>
                </div>
                <div class="animation-canvas" id="animationCanvas"></div>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" id="frameCount">0</div>
                        <div class="stat-label">å½“å‰å¸§</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="animStatus">åœæ­¢</div>
                        <div class="stat-label">çŠ¶æ€</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="starCountAnim">10</div>
                        <div class="stat-label">æ˜Ÿæ˜Ÿæ•°é‡</div>
                    </div>
                </div>
                <div class="code-example">
                    <strong>åŠ¨ç”»ç¤ºä¾‹ä»£ç ï¼š</strong><br>
                    from matplotlib.animation import FuncAnimation<br>
                    def animate(i):<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;star.set_color('#C71585' if i % 2 else 'white')<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;return star<br>
                    ani = FuncAnimation(fig, animate, frames=None, interval=1000)
                </div>
            </div>

            <!-- æ¨¡å—3: basemapç»˜åˆ¶ç»Ÿè®¡åœ°å›¾ -->
            <div class="module">
                <h2 data-emoji="ğŸ—ºï¸">7.3 basemapç»˜åˆ¶ç»Ÿè®¡åœ°å›¾</h2>
                <div class="controls">
                    <div class="control-group">
                        <label>åœ°å›¾ç±»å‹:</label>
                        <select id="mapType" onchange="updateMap()">
                            <option value="bubble">æ°”æ³¡åœ°å›¾</option>
                            <option value="scatter">æ•£ç‚¹åœ°å›¾</option>
                            <option value="heatmap">çƒ­åŠ›åœ°å›¾</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>æ•°æ®ç‚¹æ•°é‡:</label>
                        <input type="range" id="dataPoints" min="50" max="500" value="200" oninput="updateDataPoints(this.value)">
                        <span id="dataPointsValue">200</span>
                    </div>
                    <div class="control-group">
                        <label>æ°”æ³¡å¤§å°:</label>
                        <input type="range" id="bubbleSize" min="1" max="20" value="8" oninput="updateBubbleSize(this.value)">
                        <span id="bubbleSizeValue">8</span>
                    </div>
                    <div class="control-group">
                        <button onclick="updateMap()">æ›´æ–°åœ°å›¾</button>
                        <button onclick="randomizeData()">éšæœºæ•°æ®</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="mapChart"></canvas>
                </div>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" id="citiesCount">200</div>
                        <div class="stat-label">åŸå¸‚æ•°é‡</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="maxPopulation">1000</div>
                        <div class="stat-label">æœ€å¤§äººå£</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="avgPopulation">500</div>
                        <div class="stat-label">å¹³å‡äººå£</div>
                    </div>
                </div>
                <div class="code-example">
                    <strong>åœ°å›¾ç¤ºä¾‹ä»£ç ï¼š</strong><br>
                    from mpl_toolkits.basemap import Basemap<br>
                    m = Basemap(projection='stere', lat_0=90, lon_0=-105)<br>
                    m.drawcoastlines()<br>
                    m.drawstates()<br>
                    m.scatter(x, y, s=population_size)
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let stars3D = [];
        let animationFrame;
        let currentRotation = 0;
        let frameCounter = 0;
        let isAnimating = false;
        let chart3D, mapChart;

        // åˆå§‹åŒ–
        window.onload = function() {
            init3DChart();
            initAnimation();
            initMap();
            generateStars();
        };

        // 3Då›¾è¡¨åˆå§‹åŒ–
        function init3DChart() {
            const ctx = document.getElementById('chart3d').getContext('2d');
            chart3D = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: '3Dæ˜Ÿç‚¹',
                        data: [],
                        backgroundColor: 'rgba(255, 105, 180, 0.6)',
                        borderColor: 'rgba(199, 21, 133, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `åæ ‡: (${context.parsed.x}, ${context.parsed.y}, ${context.raw.z || 0})`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            min: 0,
                            max: 40,
                            title: {
                                display: true,
                                text: 'Xè½´'
                            }
                        },
                        y: {
                            min: 0,
                            max: 40,
                            title: {
                                display: true,
                                text: 'Yè½´'
                            }
                        }
                    }
                }
            });
        }

        // ç”Ÿæˆ3Dæ˜Ÿæ˜Ÿæ•°æ®
        function generateStars() {
            const count = parseInt(document.getElementById('starCount').value);
            stars3D = [];
            
            for (let i = 0; i < count; i++) {
                const x = Math.random() * 40;
                const y = Math.random() * 40;
                const z = Math.random() * 40;
                
                let color = '#FFD700'; // é»˜è®¤é‡‘è‰²
                if (z < 10) {
                    color = '#FFD700';
                } else if (z < 20) {
                    color = '#C71585'; // ç²‰è‰²
                } else {
                    color = '#008B8B'; // é’è‰²
                }
                
                stars3D.push({ x, y, z, color });
            }
            
            update3DChart();
            updateStats();
        }

        // æ›´æ–°3Då›¾è¡¨
        function update3DChart() {
            if (!chart3D) return;
            
            const chartType = document.getElementById('chartType').value;
            const data = stars3D.map(star => ({
                x: star.x,
                y: star.y,
                z: star.z
            }));
            
            chart3D.data.datasets[0].data = data;
            
            if (chartType === 'scatter') {
                chart3D.data.datasets[0].backgroundColor = stars3D.map(star => star.color + '99');
                chart3D.data.datasets[0].borderColor = stars3D.map(star => star.color);
                chart3D.data.datasets[0].pointStyle = 'star';
                chart3D.data.datasets[0].radius = 8;
            } else if (chartType === 'wireframe') {
                chart3D.data.datasets[0].backgroundColor = 'rgba(255, 105, 180, 0.1)';
                chart3D.data.datasets[0].borderColor = 'rgba(199, 21, 133, 1)';
                chart3D.data.datasets[0].showLine = true;
                chart3D.data.datasets[0].tension = 0.4;
            } else if (chartType === 'surface') {
                chart3D.data.datasets[0].backgroundColor = 'rgba(255, 182, 193, 0.3)';
                chart3D.data.datasets[0].borderColor = 'rgba(255, 105, 180, 1)';
                chart3D.data.datasets[0].fill = true;
            }
            
            chart3D.update();
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            const totalStars = stars3D.length;
            const avgHeight = (stars3D.reduce((sum, star) => sum + star.z, 0) / totalStars).toFixed(1);
            
            document.getElementById('totalStars').textContent = totalStars;
            document.getElementById('avgHeight').textContent = avgHeight;
        }

        // æ—‹è½¬å›¾è¡¨
        function rotateChart() {
            currentRotation += 45;
            document.getElementById('rotationAngle').textContent = currentRotation + 'Â°';
            
            // ç®€å•çš„æ—‹è½¬æ•ˆæœï¼šé‡æ–°æ’åˆ—æ•°æ®ç‚¹
            stars3D = stars3D.map(star => ({
                ...star,
                x: (star.x + 10) % 40,
                y: (star.y + 5) % 40
            }));
            
            update3DChart();
        }

        // æ›´æ–°æ˜Ÿç‚¹æ•°é‡
        function updateStarCount(value) {
            document.getElementById('starCountValue').textContent = value;
            generateStars();
        }

        // åˆå§‹åŒ–åŠ¨ç”»
        function initAnimation() {
            createStarsInCanvas();
        }

        // åœ¨ç”»å¸ƒä¸­åˆ›å»ºæ˜Ÿæ˜Ÿ
        function createStarsInCanvas() {
            const canvas = document.getElementById('animationCanvas');
            canvas.innerHTML = '';
            
            const starCount = 10;
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.innerHTML = 'âœ¨';
                star.style.left = Math.random() * 90 + '%';
                star.style.top = Math.random() * 80 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                star.style.fontSize = (15 + Math.random() * 15) + 'px';
                canvas.appendChild(star);
            }
            
            document.getElementById('starCountAnim').textContent = starCount;
        }

        // æ’­æ”¾åŠ¨ç”»
        function playAnimation() {
            if (isAnimating) return;
            
            isAnimating = true;
            document.getElementById('animStatus').textContent = 'æ’­æ”¾ä¸­';
            
            const animType = document.getElementById('animationType').value;
            const speed = 11 - parseInt(document.getElementById('animSpeed').value);
            
            if (animType === 'twinkle') {
                animationFrame = setInterval(() => {
                    const stars = document.querySelectorAll('#animationCanvas .star');
                    stars.forEach(star => {
                        if (Math.random() > 0.7) {
                            star.style.opacity = star.style.opacity === '0.2' ? '1' : '0.2';
                        }
                    });
                    frameCounter++;
                    document.getElementById('frameCount').textContent = frameCounter;
                }, speed * 100);
            } else if (animType === 'sine') {
                animationFrame = setInterval(() => {
                    const stars = document.querySelectorAll('#animationCanvas .star');
                    stars.forEach((star, index) => {
                        const offset = Math.sin((frameCounter + index * 10) * 0.1) * 20;
                        star.style.transform = `translateY(${offset}px)`;
                    });
                    frameCounter++;
                    document.getElementById('frameCount').textContent = frameCounter;
                }, speed * 50);
            } else if (animType === 'rotating') {
                animationFrame = setInterval(() => {
                    const canvas = document.getElementById('animationCanvas');
                    const rotation = (frameCounter * 2) % 360;
                    canvas.style.transform = `rotateZ(${rotation}deg)`;
                    frameCounter++;
                    document.getElementById('frameCount').textContent = frameCounter;
                }, speed * 20);
            }
        }

        // æš‚åœåŠ¨ç”»
        function pauseAnimation() {
            if (animationFrame) {
                clearInterval(animationFrame);
                isAnimating = false;
                document.getElementById('animStatus').textContent = 'æš‚åœ';
            }
        }

        // é‡ç½®åŠ¨ç”»
        function resetAnimation() {
            pauseAnimation();
            frameCounter = 0;
            document.getElementById('frameCount').textContent = '0';
            document.getElementById('animStatus').textContent = 'åœæ­¢';
            
            const canvas = document.getElementById('animationCanvas');
            canvas.style.transform = '';
            
            createStarsInCanvas();
        }

        // æ›´æ–°åŠ¨ç”»ç±»å‹
        function updateAnimation() {
            resetAnimation();
        }

        // æ›´æ–°åŠ¨ç”»é€Ÿåº¦
        function updateAnimSpeed(value) {
            document.getElementById('animSpeedValue').textContent = value;
            if (isAnimating) {
                pauseAnimation();
                playAnimation();
            }
        }

        // åˆå§‹åŒ–åœ°å›¾
        function initMap() {
            const ctx = document.getElementById('mapChart').getContext('2d');
            mapChart = new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: [{
                        label: 'åŸå¸‚äººå£åˆ†å¸ƒ',
                        data: [],
                        backgroundColor: 'rgba(255, 105, 180, 0.6)',
                        borderColor: 'rgba(199, 21, 133, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `äººå£: ${context.raw.v}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            min: -130,
                            max: -60,
                            title: {
                                display: true,
                                text: 'ç»åº¦'
                            }
                        },
                        y: {
                            min: 20,
                            max: 50,
                            title: {
                                display: true,
                                text: 'çº¬åº¦'
                            }
                        }
                    }
                }
            });
            
            generateMapData();
        }

        // ç”Ÿæˆåœ°å›¾æ•°æ®
        function generateMapData() {
            const count = parseInt(document.getElementById('dataPoints').value);
            const bubbleSize = parseInt(document.getElementById('bubbleSize').value);
            const data = [];
            
            for (let i = 0; i < count; i++) {
                const x = -130 + Math.random() * 70; // ç¾å›½ç»åº¦èŒƒå›´
                const y = 20 + Math.random() * 30; // ç¾å›½çº¬åº¦èŒƒå›´
                const r = Math.random() * 50 + 10; // äººå£å¤§å°
                
                data.push({ x, y, r });
            }
            
            if (mapChart) {
                mapChart.data.datasets[0].data = data;
                
                const mapType = document.getElementById('mapType').value;
                if (mapType === 'scatter') {
                    mapChart.config.type = 'scatter';
                    mapChart.data.datasets[0].pointRadius = function(context) {
                        return context.raw.r / 10;
                    };
                } else {
                    mapChart.config.type = 'bubble';
                }
                
                mapChart.update();
            }
            
            updateMapStats(data);
        }

        // æ›´æ–°åœ°å›¾ç»Ÿè®¡ä¿¡æ¯
        function updateMapStats(data) {
            const maxPop = Math.max(...data.map(d => d.r));
            const avgPop = (data.reduce((sum, d) => sum + d.r, 0) / data.length).toFixed(0);
            
            document.getElementById('citiesCount').textContent = data.length;
            document.getElementById('maxPopulation').textContent = maxPop.toFixed(0);
            document.getElementById('avgPopulation').textContent = avgPop;
        }

        // æ›´æ–°åœ°å›¾
        function updateMap() {
            generateMapData();
        }

        // éšæœºåŒ–æ•°æ®
        function randomizeData() {
            generateMapData();
        }

        // æ›´æ–°æ•°æ®ç‚¹æ•°é‡
        function updateDataPoints(value) {
            document.getElementById('dataPointsValue').textContent = value;
            generateMapData();
        }

        // æ›´æ–°æ°”æ³¡å¤§å°
        function updateBubbleSize(value) {
            document.getElementById('bubbleSizeValue').textContent = value;
            generateMapData();
        }

        // æ›´æ–°3Då›¾è¡¨ç±»å‹
        function updateChart3D() {
            update3DChart();
        }
    </script>
</body>
</html>